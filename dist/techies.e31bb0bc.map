{"version":3,"sources":["src/util.js","src/dom.js","index.js"],"names":["type","value","Object","prototype","toString","call","match","toLowerCase","removeWhiteSpace","array","dirtyData","filter","item","includes","getNumbers","str","getSelector","node","indexOf","console","warn","selector","_node","unshift","getParentSelector","parentElement","join","parent","siblings","children","tagName","length","getChildIndex","Array","numbers","selectors","Map","techies","dom","traverse","info","firstChild","s","nodeType","number","data","parentNode","has","forEach","index","push","set","get","i","nextSibling","window","Traverse"],"mappings":"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","file":"techies.e31bb0bc.map","sourceRoot":"..","sourcesContent":["export function type(value) {\n  return Object.prototype.toString\n    .call(value)\n    .match(/\\[object\\ (.*)\\]/)[1]\n    .toLowerCase();\n}\n\nexport function removeWhiteSpace(array) {\n  const dirtyData = ['', ' '];\n  return array.filter(item => !dirtyData.includes(item));\n}\n\nexport function getNumbers(str) {\n  return str.match(/([0-9]{1,}[.][0-9]*)|[0-9]{1,}/g);\n}\n\nexport function getSelector(node) {\n  // 非 dom 节点\n  if (type(node).indexOf('html') < 0) {\n    console.warn(`[techies] error dom type: ${type(node)}, need html element.`);\n    return '';\n  }\n\n  if (type(node) === 'htmlhtmlelement') {\n    return 'html';\n  }\n\n  if (type(node) === 'htmlbodyelement') {\n    return 'body';\n  }\n\n  let selector = [];\n  let _node;\n\n  while (type(node) !== 'htmlbodyelement') {\n    selector.unshift(getParentSelector(node));\n    _node = node;\n    node = node.parentElement;\n  }\n\n  return `body ${selector.join('')}`;\n}\n\nfunction getParentSelector(node) {\n  const parent = node.parentElement;\n  const siblings = parent.children;\n  const tagName = node.tagName.toLowerCase();\n\n  if (siblings && siblings.length === 1) {\n    return `> ${tagName}`;\n  } else {\n    return `> ${getChildIndex(node)}`;\n  }\n}\n\nexport function getChildIndex(node) {\n  const parent = node.parentElement;\n  const tagName = node.tagName.toLowerCase();\n  const siblings = parent.children;\n\n  return `:nth-child(${Array.prototype.indexOf.call(siblings, node) + 1})`;\n}\n","'use strict';\n/**\n * @author: tianding.wk\n * @createdTime: 2019-02-11 20:57:18\n * @fileName: dom.js\n * @description: process dom to get all number values\n **/\n\nimport {\n  type,\n  removeWhiteSpace,\n  getNumbers,\n  getSelector,\n} from './util';\n\nconst numbers = [];\nconst selectors = new Map();\n\nexport default function techies(dom) {\n  if (type(dom) !== 'htmlbodyelement') {\n    console.warn(`[techies] error dom type: ${type(dom)}, need body element, techies will exit doing nothing.`);\n    return;\n  }\n\n  traverse(dom);\n  console.info('reportData: ', removeWhiteSpace(numbers));\n}\n\nfunction traverse(node) {\n  const firstChild = node.firstChild;\n\n  let s = firstChild;\n  while (s) {\n    if (s.nodeType === 1) {\n      traverse(s);\n    } else if (s.nodeType === 3) {\n      const number = getNumbers(s.data);\n      if (number) {\n        const selector = getSelector(s.parentNode);\n        if (!selectors.has(selector)) {\n          number.forEach((item, index) => {\n            numbers.push({\n              selector: `${selector}-${index}`,\n              number: item,\n            });\n          });\n          selectors.set(selector, number.length);\n        } else {\n          const index = selectors.get(selector);\n          number.forEach((item, i) => {\n            numbers.push({\n              selector: `${selector}-${i + index}`,\n              number: item,\n            });\n          });\n          selectors.set(selector, index + number.length);\n        }\n      }\n    }\n    const nextSibling = s.nextSibling;\n    s = nextSibling;\n  }\n}\n","'use strict';\n/**\n * @author: tianding.wk\n * @createdTime: 2019-02-11 20:56:19\n * @fileName: index.js\n * @description: entry file\n **/\n\n// module.exports = exports = require('./src/dom.js');\nimport traverse from './src/dom';\n\nwindow.Traverse = traverse;\n// traverse(document.body);\nexport default traverse;\n"]}