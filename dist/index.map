{"version":3,"sources":["src/util.js","src/dom.js","index.js"],"names":["type","value","Object","prototype","toString","call","match","toLowerCase","removeWhiteSpace","array","dirtyData","filter","item","includes","getNumbers","str","getSelector","node","indexOf","console","warn","selector","unshift","getParentSelector","parentElement","join","parent","siblings","children","tagName","length","getChildIndex","Array","numbers","selectors","Map","techies","dom","traverse","info","s","firstChild","nodeType","number","data","parentNode","has","index","get","forEach","i","push","set","nextSibling","window","Traverse"],"mappings":"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","file":"index.map","sourceRoot":"..","sourcesContent":["export function type(value) {\n  return Object.prototype.toString\n    .call(value)\n    .match(/\\[object\\ (.*)\\]/)[1]\n    .toLowerCase();\n}\n\nexport function removeWhiteSpace(array) {\n  const dirtyData = ['', ' '];\n  return array.filter(item => !dirtyData.includes(item));\n}\n\n// 匹配小数和整数。带符号\nexport function getNumbers(str) {\n  return str.match(/([+-]?[0-9]{1,}[.][0-9]*)|[+-]?[0-9]{1,}/g);\n}\n\nexport function getSelector(node) {\n  // 非 dom 节点\n  if (type(node).indexOf('html') < 0) {\n    console.warn(`[techies] error dom type: ${type(node)}, need html element.`);\n    return '';\n  }\n\n  if (type(node) === 'htmlhtmlelement') {\n    return 'html';\n  }\n\n  if (type(node) === 'htmlbodyelement') {\n    return 'body';\n  }\n\n  let selector = [];\n  let _node;\n\n  while (type(node) !== 'htmlbodyelement') {\n    selector.unshift(getParentSelector(node));\n    _node = node;\n    node = node.parentElement;\n  }\n\n  return `body ${selector.join('')}`;\n}\n\nfunction getParentSelector(node) {\n  const parent = node.parentElement;\n  const siblings = parent.children;\n  const tagName = node.tagName.toLowerCase();\n\n  if (siblings && siblings.length === 1) {\n    return `> ${tagName}`;\n  } else {\n    return `> ${getChildIndex(node)}`;\n  }\n}\n\nexport function getChildIndex(node) {\n  const parent = node.parentElement;\n  const tagName = node.tagName.toLowerCase();\n  const siblings = parent.children;\n\n  return `:nth-child(${Array.prototype.indexOf.call(siblings, node) + 1})`;\n}\n","'use strict';\n/**\n * @author: tianding.wk\n * @createdTime: 2019-02-11 20:57:18\n * @fileName: dom.js\n * @description: process dom to get all number values\n **/\n\nimport {\n  type,\n  removeWhiteSpace,\n  getNumbers,\n  getSelector,\n} from './util';\n\nlet numbers = [];\nconst selectors = new Map();\n\nexport default function techies(dom) {\n  if (type(dom) !== 'htmlbodyelement') {\n    console.warn(`[techies] error dom type: ${type(dom)}, need body element, techies will exit doing nothing.`);\n    return;\n  }\n\n  traverse(dom);\n  console.info('reportData: ', removeWhiteSpace(numbers));\n  numbers = [];\n}\n\nfunction traverse(node) {\n  const firstChild = node.firstChild;\n\n  let s = firstChild;\n  while (s) {\n    if (s.nodeType === 1) {\n      traverse(s);\n    } else if (s.nodeType === 3) {\n      const number = getNumbers(s.data);\n      if (number) {\n        const selector = getSelector(s.parentNode);\n        if (!selectors.has(selector)) {\n          number.forEach((item, index) => {\n            numbers.push({\n              selector: `${selector}-${index}`,\n              number: item,\n            });\n          });\n          selectors.set(selector, number.length);\n        } else {\n          const index = selectors.get(selector);\n          number.forEach((item, i) => {\n            numbers.push({\n              selector: `${selector}-${i + index}`,\n              number: item,\n            });\n          });\n          selectors.set(selector, index + number.length);\n        }\n      }\n    }\n    const nextSibling = s.nextSibling;\n    s = nextSibling;\n  }\n}\n","'use strict';\n/**\n * @author: tianding.wk\n * @createdTime: 2019-02-11 20:56:19\n * @fileName: index.js\n * @description: entry file\n **/\n\n// module.exports = exports = require('./src/dom.js');\nimport traverse from './src/dom';\n\nwindow.Traverse = traverse;\n// traverse(document.body);\nexport default traverse;\n"]}